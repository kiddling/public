{"version":3,"file":"useChatTitle.mjs","sources":["../../../../../admin/src/components/AIChat/hooks/useChatTitle.ts"],"sourcesContent":["/**\n * Hook that requests a new title based on the first message\n */\nimport { useState, useCallback } from 'react';\n\nimport { useFetchGenerateTitle } from './useAIFetch';\n\nimport type { UIMessage } from '@ai-sdk/react';\n\ninterface UseChatTitleProps {\n  chatId: string;\n  messages: UIMessage[];\n}\n\nexport const useChatTitle = ({ chatId, messages }: UseChatTitleProps) => {\n  const [title, setTitle] = useState<string | undefined>(undefined);\n\n  // Use the endpoint-specific hook\n  const { fetch: fetchGenerateTitle, error, isPending: isGenerating } = useFetchGenerateTitle();\n\n  const generateTitle = useCallback(async () => {\n    const firstMessage = messages.at(0);\n\n    // Only generate title if there are messages and no title yet\n    if (!firstMessage || title || isGenerating || error) {\n      return;\n    }\n\n    const firstMessageContent = firstMessage.parts\n      .map((content) => (content.type === 'text' ? content.text : ''))\n      .join('\\n');\n\n    const result = await fetchGenerateTitle({\n      body: { chatId, message: firstMessageContent },\n    });\n\n    if (result?.data) {\n      setTitle(result.data.title);\n    }\n  }, [messages, title, isGenerating, error, fetchGenerateTitle, chatId]);\n\n  const resetTitle = useCallback(() => {\n    setTitle(undefined);\n  }, []);\n\n  return {\n    title,\n    isGenerating,\n    error,\n    generateTitle,\n    resetTitle,\n  };\n};\n"],"names":["useChatTitle","chatId","messages","title","setTitle","useState","undefined","fetch","fetchGenerateTitle","error","isPending","isGenerating","useFetchGenerateTitle","generateTitle","useCallback","firstMessage","at","firstMessageContent","parts","map","content","type","text","join","result","body","message","data","resetTitle"],"mappings":";;;MAcaA,YAAe,GAAA,CAAC,EAAEC,MAAM,EAAEC,QAAQ,EAAqB,GAAA;AAClE,IAAA,MAAM,CAACC,KAAAA,EAAOC,QAAS,CAAA,GAAGC,QAA6BC,CAAAA,SAAAA,CAAAA;;IAGvD,MAAM,EAAEC,OAAOC,kBAAkB,EAAEC,KAAK,EAAEC,SAAAA,EAAWC,YAAY,EAAE,GAAGC,qBAAAA,EAAAA;AAEtE,IAAA,MAAMC,gBAAgBC,WAAY,CAAA,UAAA;QAChC,MAAMC,YAAAA,GAAeb,QAASc,CAAAA,EAAE,CAAC,CAAA,CAAA;;AAGjC,QAAA,IAAI,CAACD,YAAAA,IAAgBZ,KAASQ,IAAAA,YAAAA,IAAgBF,KAAO,EAAA;AACnD,YAAA;AACF;AAEA,QAAA,MAAMQ,sBAAsBF,YAAaG,CAAAA,KAAK,CAC3CC,GAAG,CAAC,CAACC,OAAAA,GAAaA,OAAQC,CAAAA,IAAI,KAAK,MAASD,GAAAA,OAAAA,CAAQE,IAAI,GAAG,EAAA,CAAA,CAC3DC,IAAI,CAAC,IAAA,CAAA;QAER,MAAMC,MAAAA,GAAS,MAAMhB,kBAAmB,CAAA;YACtCiB,IAAM,EAAA;AAAExB,gBAAAA,MAAAA;gBAAQyB,OAAST,EAAAA;AAAoB;AAC/C,SAAA,CAAA;AAEA,QAAA,IAAIO,QAAQG,IAAM,EAAA;YAChBvB,QAASoB,CAAAA,MAAAA,CAAOG,IAAI,CAACxB,KAAK,CAAA;AAC5B;KACC,EAAA;AAACD,QAAAA,QAAAA;AAAUC,QAAAA,KAAAA;AAAOQ,QAAAA,YAAAA;AAAcF,QAAAA,KAAAA;AAAOD,QAAAA,kBAAAA;AAAoBP,QAAAA;AAAO,KAAA,CAAA;AAErE,IAAA,MAAM2B,aAAad,WAAY,CAAA,IAAA;QAC7BV,QAASE,CAAAA,SAAAA,CAAAA;AACX,KAAA,EAAG,EAAE,CAAA;IAEL,OAAO;AACLH,QAAAA,KAAAA;AACAQ,QAAAA,YAAAA;AACAF,QAAAA,KAAAA;AACAI,QAAAA,aAAAA;AACAe,QAAAA;AACF,KAAA;AACF;;;;"}