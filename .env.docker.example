# Docker Compose Environment Variables
# Docker Compose 环境变量
#
# Copy this file to .env.docker and update with your values
# 将此文件复制为 .env.docker 并更新为您的值
#
# Usage (使用方法):
# cp .env.docker.example .env.docker
# 
# Then edit .env.docker with your actual configuration values
# 然后编辑 .env.docker 填入实际配置值

# ===== Node Environment =====
NODE_ENV=production

# ===== Timezone Configuration (时区配置) =====
# Default timezone for all containers
# 所有容器的默认时区
TZ=Asia/Shanghai

# ===== Database Configuration (数据库配置) =====
DATABASE_CLIENT=postgres
DATABASE_HOST=postgres
DATABASE_PORT=5432
DATABASE_NAME=strapi
DATABASE_USERNAME=strapi
DATABASE_PASSWORD=change_me_in_production
DATABASE_SSL=false

# PostgreSQL specific (PostgreSQL 特定配置)
PGTZ=Asia/Shanghai

# ===== Strapi Security Keys (Strapi 安全密钥) =====
# Generate with: openssl rand -base64 32
# 生成命令: openssl rand -base64 32
#
# IMPORTANT: Generate unique keys for production!
# 重要提示：为生产环境生成唯一的密钥！
#
# APP_KEYS: 应用密钥数组，用于会话加密和签名
# APP_KEYS: Array of keys for session encryption and signing
# 必须提供至少 4 个密钥，逗号分隔
# Must provide at least 4 keys, comma-separated
APP_KEYS=key1,key2,key3,key4
#
# API_TOKEN_SALT: API 令牌加密盐值
# API_TOKEN_SALT: Salt for API token encryption
API_TOKEN_SALT=your_api_token_salt
#
# ADMIN_JWT_SECRET: 管理员 JWT 令牌密钥
# ADMIN_JWT_SECRET: Secret for admin JWT tokens
ADMIN_JWT_SECRET=your_admin_jwt_secret
#
# TRANSFER_TOKEN_SALT: 传输令牌加密盐值
# TRANSFER_TOKEN_SALT: Salt for transfer token encryption
TRANSFER_TOKEN_SALT=your_transfer_token_salt
#
# JWT_SECRET: 用户 JWT 令牌密钥
# JWT_SECRET: Secret for user JWT tokens
JWT_SECRET=your_jwt_secret
#
# ENCRYPTION_KEY: 数据加密密钥（用于加密敏感数据）
# ENCRYPTION_KEY: Data encryption key (for encrypting sensitive data)
ENCRYPTION_KEY=your_encryption_key

# ===== Server Configuration (服务器配置) =====
HOST=0.0.0.0
PORT=1337
CLIENT_URL=http://localhost:3000

# ===== Nuxt Configuration (Nuxt 配置) =====

# Node Environment (Node 环境)
# Used by Nuxt to determine runtime behavior
# Nuxt 使用此变量确定运行时行为
NODE_ENV=production

# Server Configuration (服务器配置)
# Host and port that Nuxt server listens on
# Nuxt 服务器监听的主机和端口
HOST=0.0.0.0
PORT=3000

# Timezone (时区)
# Asia/Shanghai for China deployments
# 中国部署使用 Asia/Shanghai
TZ=Asia/Shanghai

# Internal service-to-service communication
# 内部服务间通信（使用容器名称）
# These URLs are used by Nuxt server to communicate with Strapi
# 这些 URL 供 Nuxt 服务器与 Strapi 通信使用
NUXT_STRAPI_URL=http://cms:1337
NUXT_PUBLIC_API_BASE_URL=http://cms:1337

# Public-facing URLs (for browser access)
# 公开访问的 URL（浏览器访问用）
# These URLs are used by the browser to access services
# 这些 URL 供浏览器访问服务使用
NUXT_PUBLIC_STRAPI_URL=http://localhost:1337

# Strapi API Token (Strapi API 令牌)
# Generate this in Strapi admin panel: Settings > API Tokens
# 在 Strapi 管理面板生成: 设置 > API 令牌
# ⚠️ Change in production! 生产环境必须更改！
NUXT_STRAPI_API_TOKEN=your_strapi_api_token

# ===== Security Configuration (安全配置) =====
# Security Headers (安全标头)
SECURITY_HSTS_ENABLED=true
SECURITY_HSTS_MAX_AGE=31536000
SECURITY_CSP_ENABLED=true
SECURITY_CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost
SECURITY_CORS_CREDENTIALS=true

# Rate Limiting (访问频率限制)
SECURITY_RATE_LIMIT_ENABLED=true
SECURITY_RATE_LIMIT_MAX_REQUESTS=100
SECURITY_RATE_LIMIT_WINDOW_MS=60000
SECURITY_API_RATE_LIMIT_MAX_REQUESTS=1000
SECURITY_API_RATE_LIMIT_WINDOW_MS=60000

# Cookie Security (Cookie 安全)
SECURITY_SECURE_COOKIES=false
SECURITY_SAME_SITE=lax

# ===== Compliance Configuration (合规配置) =====
# ICP Filing (ICP 备案)
# Required for China deployment
# 中国部署必需
ICP_FILING_NUMBER=
PUBLIC_SECURITY_FILING_NUMBER=

# Privacy & Cookie Compliance (隐私与 Cookie 合规)
PRIVACY_POLICY_URL=/privacy-policy
COOKIE_POLICY_URL=/cookie-policy
COOKIE_CONSENT_ENABLED=true

# Data Residency (数据驻留)
DATA_RESIDENCY=CN
DATABASE_REGION=cn-beijing
CDN_REGION=cn

# Personal Information Protection (个人信息保护)
PERSONAL_INFO_PROTECTION_ENABLED=true
PERSONAL_INFO_OFFICER_NAME=
PERSONAL_INFO_OFFICER_EMAIL=
PERSONAL_INFO_OFFICER_PHONE=

# Multi-Level Protection Scheme (网络安全等级保护)
MLPS_LEVEL=2
MLPS_FILING_NUMBER=

# Content Moderation (内容审核)
CONTENT_MODERATION_ENABLED=false
CONTENT_MODERATION_PROVIDER=

# Real-name Verification (实名认证)
REAL_NAME_VERIFICATION_ENABLED=false

# Minor Protection (未成年人保护)
MINOR_PROTECTION_ENABLED=true
MIN_AGE_REQUIREMENT=14

# Audit Logging (审计日志)
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=180

# Cross-border Data Transfer (跨境数据传输)
CROSS_BORDER_DATA_TRANSFER_ENABLED=false

# ===== Redis Configuration (Redis 配置) =====
REDIS_HOST=redis
REDIS_PORT=6379
# Maximum memory allocation for Redis
# Redis 最大内存分配
REDIS_MAX_MEMORY=256mb
# Memory eviction policy
# 内存淘汰策略
REDIS_MAX_MEMORY_POLICY=allkeys-lru

# ===== Nginx Configuration (Nginx 配置) =====
# Rate limiting
# 访问频率限制
NGINX_RATE_LIMIT_API=10r/s
NGINX_RATE_LIMIT_GENERAL=100r/s

# ===== Docker Resource Configuration (Docker 资源配置) =====
# Volume mount paths (数据卷挂载路径)
# These paths are relative to the docker-compose.yml location
# 这些路径相对于 docker-compose.yml 文件位置
POSTGRES_DATA_PATH=./data/postgres
CMS_UPLOADS_PATH=./data/cms_uploads
REDIS_DATA_PATH=./data/redis
NGINX_LOGS_PATH=./data/nginx_logs

# Network configuration (网络配置)
# Customize if you have conflicts with existing networks
# 如果与现有网络冲突，可自定义
DOCKER_SUBNET=172.28.0.0/16
DOCKER_GATEWAY=172.28.0.1

# ===== Container Image Configuration (容器镜像配置) =====
# Specify custom image names or registry
# 指定自定义镜像名称或镜像仓库
CMS_IMAGE=nuxt-strapi-cms:latest
FRONTEND_IMAGE=nuxt-strapi-frontend:latest

# For China deployment with Alibaba Cloud Container Registry:
# 中国部署使用阿里云容器镜像服务：
# CMS_IMAGE=registry.cn-hangzhou.aliyuncs.com/your-namespace/cms:latest
# FRONTEND_IMAGE=registry.cn-hangzhou.aliyuncs.com/your-namespace/frontend:latest

# For private Docker registry:
# 使用私有 Docker 镜像仓库：
# CMS_IMAGE=registry.example.com/cms:latest
# FRONTEND_IMAGE=registry.example.com/frontend:latest

# ===== CDN Configuration (CDN 配置) =====
# CDN URL for static assets (China optimization)
# 静态资源 CDN URL（中国优化）
CDN_URL_CN=

# ===== Monitoring & Logging (监控与日志) =====
# Enable detailed application logging
# 启用详细的应用日志
ENABLE_DETAILED_LOGGING=true
LOG_LEVEL=info

# Log rotation is configured in docker-compose.yml
# 日志轮转在 docker-compose.yml 中配置
# - max-size: 10m (Maximum size of log file)
# - max-file: 3-5 (Number of log files to retain)

# ===== Backup Configuration (备份配置) =====
# Backup retention period (days)
# 备份保留期限（天）
BACKUP_RETENTION_DAYS=30

# Backup schedule (cron format)
# 备份计划（cron 格式）
# Default: 2 AM daily
# 默认：每天凌晨 2 点
BACKUP_SCHEDULE=0 2 * * *

# ===== China Network Optimization (中国网络优化) =====
# To use China mirrors, run with:
# 使用中国镜像源，运行命令：
# docker-compose -f docker-compose.yml -f docker-compose.china.yml up -d
#
# The docker-compose.china.yml file provides:
# docker-compose.china.yml 文件提供：
# - Chinese mirror registries for faster image pulls
#   使用中国镜像源以加快镜像拉取速度
# - npm/pnpm Chinese mirrors configuration
#   npm/pnpm 中国镜像源配置
# - Custom hosts mapping for better connectivity
#   自定义主机映射以提高连接性
#
# ===== Docker Build Arguments (Docker 构建参数) =====

# Build arguments for China network optimization
# 中国网络优化的构建参数
#
# These arguments are used during docker build to configure registry mirrors
# 这些参数在 docker build 时使用，用于配置镜像源
#
# Leave empty to use default registries (faster outside China)
# 留空则使用默认源（中国境外更快）
# Set to China mirrors for faster builds in China
# 设置为中国镜像源以在中国境内加速构建

# NPM Registry Mirror (npm 镜像源)
NPM_REGISTRY=https://registry.npmjs.org/
# For China (中国境内): https://registry.npmmirror.com

# pnpm Registry Mirror (pnpm 镜像源)
PNPM_REGISTRY=https://registry.npmjs.org/
# For China (中国境内): https://registry.npmmirror.com

# Alpine Linux Package Mirror (Alpine 软件包镜像源)
ALPINE_MIRROR=
# For China (中国境内): mirrors.ustc.edu.cn or mirrors.aliyun.com

# Build CMS image with China mirrors:
# 使用中国镜像源构建 CMS 镜像：
# docker build --build-arg USE_CHINA_MIRROR=true \
#   --build-arg NODE_MIRROR=https://registry.npmmirror.com \
#   --build-arg ALPINE_MIRROR=mirrors.aliyun.com \
#   -t cms:latest apps/cms
#
# Build Frontend image with China mirrors:
# 使用中国镜像源构建 Frontend 镜像：
# docker build --build-arg NPM_REGISTRY=https://registry.npmmirror.com \
#   --build-arg PNPM_REGISTRY=https://registry.npmmirror.com \
#   --build-arg ALPINE_MIRROR=mirrors.ustc.edu.cn \
#   -f apps/frontend/Dockerfile -t frontend:latest .
#
# Default (no China mirrors):
# 默认（不使用中国镜像源）：
# docker build -t cms:latest apps/cms
# docker build -f apps/frontend/Dockerfile -t frontend:latest .

# ===== Development vs Production Notes (开发与生产环境注意事项) =====
# Development (开发环境):
# - Use docker-compose.dev.yml for development databases only
#   使用 docker-compose.dev.yml 仅启动开发数据库
# - Run application code locally for hot-reload
#   在本地运行应用代码以支持热重载
#
# Production (生产环境):
# - Use docker-compose.yml with this .env.docker file
#   使用 docker-compose.yml 配合本 .env.docker 文件
# - Generate strong, unique secrets for all keys
#   为所有密钥生成强且唯一的秘钥
# - Enable HTTPS and security headers
#   启用 HTTPS 和安全标头
# - Configure proper backup strategy
#   配置适当的备份策略
# - Set up monitoring and alerting
#   设置监控和告警
# - Review and complete ICP filing for China
#   检查并完成中国 ICP 备案
